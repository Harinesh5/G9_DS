1. SELECT countryname, continent
    FROM country
    ORDER BY continent; 

2. SELECT continent, COUNT(*) AS numcountries
    FROM countries
   GROUP BY continent;

3. select countries.countryname, countries.continent
    from countries
    left join car_makers on countries.countryid = car_makers.country
   where car_makers.id is null;

4.SELECT * FROM car_makers 
    WHERE country = 4;

5. select distinct maker
from car_makers
where country in (select countryid from countries where continent in (select contid from continents where continent in ('france', 'america')));

6. select countries.countryname, continents.continent
from car_makers
join countries on car_makers.country = countries.countryid
join continents on countries.continent = continents.contid
where car_makers.maker = 'volvo';

7. SELECT * FROM model_details
WHERE maker = (SELECT id FROM car_makers WHERE maker = 'ford');

8. select count(distinct m.modelid) as num_car_models
from car_makers cm
join model_details m on cm.id = m.maker
join countries c on cm.country = c.countryid
where c.countryname = 'germany';

9. select distinct m.model, cm.maker, cm.fullname
from model_details m
inner join car_makers cm on m.maker = cm.id
where cm.country = 4;

10. SELECT 
    CAR_MAKERS.MAKER,
    COUNTRIES.COUNTRYNAME AS COUNTRY,
    CONTINENTS.CONTINENT,
    MODEL_DETAILS.MODEL,
    CAR_DETAILS.MPG AS HIGHEST_MPG,
    LOWEST_MPG.MPG AS LOWEST_MPG,
    CAR_DETAILS.CYLINDERS AS HIGHEST_CYLINDERS,
    LOWEST_CYLINDERS.CYLINDERS AS LOWEST_CYLINDERS,
    CAR_DETAILS.EDISPL AS HIGHEST_EDISPL,
    LOWEST_EDISPL.EDISPL AS LOWEST_EDISPL,
    CAR_DETAILS.HORSEPOWER AS HIGHEST_HORSEPOWER,
    LOWEST_HORSEPOWER.HORSEPOWER AS LOWEST_HORSEPOWER,
    CAR_DETAILS.WEIGHT AS HIGHEST_WEIGHT,
    LOWEST_WEIGHT.WEIGHT AS LOWEST_WEIGHT,
    CAR_DETAILS.ACCEL AS HIGHEST_ACCEL,
    LOWEST_ACCEL.ACCEL AS LOWEST_ACCEL
FROM CAR_MAKERS
JOIN MODEL_DETAILS ON CAR_MAKERS.ID = MODEL_DETAILS.MAKER
JOIN CAR_DETAILS ON MODEL_DETAILS.MODELID = CAR_DETAILS.ID

JOIN (
    SELECT 
        MODEL_DETAILS.MAKER,
        MAX(CAR_DETAILS.MPG) AS MPG,
        MAX(CAR_DETAILS.CYLINDERS) AS CYLINDERS,
        MAX(CAR_DETAILS.EDISPL) AS EDISPL,
        MAX(CAR_DETAILS.HORSEPOWER) AS HORSEPOWER,
        MAX(CAR_DETAILS.WEIGHT) AS WEIGHT,
        MAX(CAR_DETAILS.ACCEL) AS ACCEL
    FROM MODEL_DETAILS
    JOIN CAR_DETAILS ON MODEL_DETAILS.MODELID = CAR_DETAILS.ID
    GROUP BY MODEL_DETAILS.MAKER
) LOWEST_MPG ON CAR_MAKERS.ID = LOWEST_MPG.MAKER

JOIN COUNTRIES ON CAR_MAKERS.COUNTRY = COUNTRIES.COUNTRYID
JOIN CONTINENTS ON COUNTRIES.CONTINENT = CONTINENTS.CONTID


JOIN (
    SELECT 
        MODEL_DETAILS.MAKER,
        MIN(CAR_DETAILS.MPG) AS MPG,
        MIN(CAR_DETAILS.CYLINDERS) AS CYLINDERS,
        MIN(CAR_DETAILS.EDISPL) AS EDISPL,
        MIN(CAR_DETAILS.HORSEPOWER) AS HORSEPOWER,
        MIN(CAR_DETAILS.WEIGHT) AS WEIGHT,
        MIN(CAR_DETAILS.ACCEL) AS ACCEL
    FROM MODEL_DETAILS
    JOIN CAR_DETAILS ON MODEL_DETAILS.MODELID = CAR_DETAILS.ID
    GROUP BY MODEL_DETAILS.MAKER
) LOWEST_CYLINDERS ON CAR_MAKERS.ID = LOWEST_CYLINDERS.MAKER

JOIN (
    SELECT 
        MODEL_DETAILS.MAKER,
        MIN(CAR_DETAILS.MPG) AS MPG,
        MIN(CAR_DETAILS.CYLINDERS) AS CYLINDERS,
        MIN(CAR_DETAILS.EDISPL) AS EDISPL,
        MIN(CAR_DETAILS.HORSEPOWER) AS HORSEPOWER,
        MIN(CAR_DETAILS.WEIGHT) AS WEIGHT,
        MIN(CAR_DETAILS.ACCEL) AS ACCEL
    FROM MODEL_DETAILS
    JOIN CAR_DETAILS ON MODEL_DETAILS.MODELID = CAR_DETAILS.ID
    GROUP BY MODEL_DETAILS.MAKER
) LOWEST_EDISPL ON CAR_MAKERS.ID = LOWEST_EDISPL.MAKER

JOIN (
    SELECT 
        MODEL_DETAILS.MAKER,
        MIN(CAR_DETAILS.MPG) AS MPG,
        MIN(CAR_DETAILS.CYLINDERS) AS CYLINDERS,
        MIN(CAR_DETAILS.EDISPL) AS EDISPL,
        MIN(CAR_DETAILS.HORSEPOWER) AS HORSEPOWER,
        MIN(CAR_DETAILS.WEIGHT) AS WEIGHT,
        MIN(CAR_DETAILS.ACCEL) AS ACCEL
    FROM MODEL_DETAILS
    JOIN CAR_DETAILS ON MODEL_DETAILS.MODELID = CAR_DETAILS.ID
    GROUP BY MODEL_DETAILS.MAKER
) LOWEST_HORSEPOWER ON CAR_MAKERS.ID = LOWEST_HORSEPOWER.MAKER

JOIN (
    SELECT 
        MODEL_DETAILS.MAKER,
        MIN(CAR_DETAILS.MPG) AS MPG,
        MIN(CAR_DETAILS.CYLINDERS) AS CYLINDERS,
        MIN(CAR_DETAILS.EDISPL) AS EDISPL,
        MIN(CAR_DETAILS.HORSEPOWER) AS HORSEPOWER,
        MIN(CAR_DETAILS.WEIGHT) AS WEIGHT,
        MIN(CAR_DETAILS.ACCEL) AS ACCEL
    FROM MODEL_DETAILS
    JOIN CAR_DETAILS ON MODEL_DETAILS.MODELID = CAR_DETAILS.ID
    GROUP BY MODEL_DETAILS.MAKER
) LOWEST_WEIGHT ON CAR_MAKERS.ID = LOWEST_WEIGHT.MAKER

JOIN (
    SELECT 
        MODEL_DETAILS.MAKER,
        MIN(CAR_DETAILS.MPG) AS MPG,
        MIN(CAR_DETAILS.CYLINDERS) AS CYLINDERS,
        MIN(CAR_DETAILS.EDISPL) AS EDISPL,
        MIN(CAR_DETAILS.HORSEPOWER) AS HORSEPOWER,
        MIN(CAR_DETAILS.WEIGHT) AS WEIGHT,
        MIN(CAR_DETAILS.ACCEL) AS ACCEL
    FROM MODEL_DETAILS
    JOIN CAR_DETAILS ON MODEL_DETAILS.MODELID = CAR_DETAILS.ID
    GROUP BY MODEL_DETAILS.MAKER
) LOWEST_ACCEL ON CAR_MAKERS.ID = LOWEST_ACCEL.MAKER

ORDER BY CAR_MAKERS.MAKER, MODEL_DETAILS.MODEL;

11. SELECT year, COUNT(*) AS car_count
FROM car_details
GROUP BY year
ORDER BY car_count DESC
FETCH FIRST 1 ROW ONLY;

12. select year, count(*) as car_count
from car_details
group by year
order by car_count asc
fetch first row only;

13. SELECT MIN(MPG) AS min_mpg, MAX(MPG) AS max_mpg, AVG(MPG) AS avg_mpg
FROM CAR_DETAILS;
SELECT MIN(CYLINDERS) AS min_cylinders, MAX(CYLINDERS) AS max_cylinders, AVG(CYLINDERS) AS avg_cylinders
FROM CAR_DETAILS;
SELECT MIN(EDISPL) AS min_edispl, MAX(EDISPL) AS max_edispl, AVG(EDISPL) AS avg_edispl
FROM CAR_DETAILS;
SELECT MIN(HORSEPOWER) AS min_horsepower, MAX(HORSEPOWER) AS max_horsepower, AVG(HORSEPOWER) AS avg_horsepower
FROM CAR_DETAILS;
SELECT MIN(WEIGHT) AS min_weight, MAX(WEIGHT) AS max_weight, AVG(WEIGHT) AS avg_weight
FROM CAR_DETAILS;
SELECT MIN(ACCEL) AS min_accel, MAX(ACCEL) AS max_accel, AVG(ACCEL) AS avg_accel
FROM CAR_DETAILS;

14.
SELECT
  AVG(HORSEPOWER) AS mean_horsepower,
  PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY HORSEPOWER) AS median_horsepower,
  STDDEV(HORSEPOWER) AS std_dev_horsepower
FROM CAR_DETAILS;

SELECT
  AVG(WEIGHT) AS mean_weight,
  PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY WEIGHT) AS median_weight,
  STDDEV(WEIGHT) AS std_dev_weight
FROM CAR_DETAILS;

SELECT
  AVG(ACCEL) AS mean_acceleration,
  PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY ACCEL) AS median_acceleration,
  STDDEV(ACCEL) AS std_dev_acceleration
FROM CAR_DETAILS;

15.
